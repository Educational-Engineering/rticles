\documentclass[10pt,paper=17cm:22cm, twoside=true, DIV=14]{scrbook}
\usepackage{scrhack}
\usepackage[ngerman]{babel}
% ============ Input Encoding ================

\usepackage[utf8]{inputenc}

\usepackage[T1]{fontenc}

% activate={true,nocompatibility} - activate protrusion and expansion
% final - enable microtype; use "draft" to disable
% tracking=true, kerning=true, spacing=true - activate these techniques
% factor=1100 - add 10% to the protrusion amount (default is 1000)
% stretch=10, shrink=10 - reduce stretchability/shrinkability (default is 20/20)
\usepackage[activate={true,nocompatibility},final,tracking=true,kerning=true,spacing=true,factor=1000,stretch=10,shrink=10]{microtype}

% ============= Avoid page breaks after paragraph and subsection =====================
\usepackage{xpatch}
\xpretocmd{\paragraph}{\needspace{1in}}{}{}
\xpretocmd{\subsubsection}{\needspace{1in}}{}{}


% ============ Mathematik ================
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}

% ============ Tables ================
\usepackage{longtable}
\usepackage{booktabs}
\usepackage{array}

%more space between rows in Tables
\renewcommand{\arraystretch}{1.3}
\newcommand{\ra}[1]{\renewcommand{\arraystretch}{#1}}


% ============ Absaetze ================
\setlength{\parindent}{0pt}
\setlength{\parskip}{4pt}
\setkomafont{subparagraph}{\normalsize}



% ============ Bilder anpassen ================
\usepackage{graphicx}
\usepackage[export]{adjustbox}
\usepackage{subfigure}



% ============ Fonts ================
\usepackage{textcomp}



%% use the option 'defaultsans' instead of 'default' to replace the
%% sans serif font only.
\usepackage[defaultsans,oldstyle,scale=1.0]{opensans} %% Alternatively



% ============ Colors & Boxes ================
\usepackage[framemethod=TikZ]{mdframed}
\usepackage{color}
\definecolor{taskColor}{RGB}{141,198,63} %green
\definecolor{infoColor}{RGB}{0,155,240} %blue
\definecolor{abstractColor}{RGB}{238,42,123} %red
\definecolor{orderColor}{RGB}{255,236,0} %yellow
\definecolor{gray}{RGB}{232,233,235}
\definecolor{grayLighter}{RGB}{241,242,242}

\mdfdefinestyle{task}{%
    linecolor=taskColor,
    outerlinewidth=1pt,
    roundcorner=10pt,
    innertopmargin=0.7\baselineskip,
    innerbottommargin=0.7\baselineskip,
    innerrightmargin=20pt,
    innerleftmargin=20pt,
    nobreak=true,
    backgroundcolor=gray}
\mdfdefinestyle{info}{%
    linecolor=infoColor,
    outerlinewidth=1pt,
    roundcorner=10pt,
    innertopmargin=0.7\baselineskip,
    innerbottommargin=0.7\baselineskip,
    innerrightmargin=20pt,
    innerleftmargin=20pt,
    nobreak=true,
    backgroundcolor=gray}
\mdfdefinestyle{abstract}{%
    linecolor=abstractColor,
    outerlinewidth=1pt,
    roundcorner=10pt,
    innertopmargin=0.7\baselineskip,
    innerbottommargin=0.7\baselineskip,
    innerrightmargin=20pt,
    innerleftmargin=20pt,
    nobreak=true,
    backgroundcolor=gray}
\mdfdefinestyle{order}{%
    linecolor=orderColor,
    outerlinewidth=1pt,
    roundcorner=10pt,
    innertopmargin=0.7\baselineskip,
    innerbottommargin=0.7\baselineskip,
    innerrightmargin=20pt,
    innerleftmargin=20pt,
    nobreak=true,
    backgroundcolor=gray}
\mdfdefinestyle{code}{
    topline=false,
    rightline=false,
    leftline=false,
    bottomline=false,
    roundcorner=10pt,
    innertopmargin=5pt,
    innerbottommargin=5pt,
    innerrightmargin=10pt,
    innerleftmargin=10pt,
    nobreak=true,
    backgroundcolor=grayLighter}

\newenvironment {task}
         {\begin{mdframed}[style=task] }
         {\end{mdframed} }

 \newenvironment {info}
          {\begin{mdframed}[style=info] }
          {\end{mdframed} }

\newenvironment {order}
         {\begin{mdframed}[style=order] }
         {\end{mdframed}}
\makeatletter
\@ifundefined{abstract}{
	\newenvironment {abstract}
        {\begin{mdframed}[style=abstract] }
         {\end{mdframed}}
}
{
	\renewenvironment {abstract}
        {\begin{mdframed}[style=abstract] }
         {\end{mdframed}}
}
\makeatother

% ============ Syntax Highlighting ================
  % commands and environments needed by pandoc snippets
     % extracted from the output of `pandoc -s`

\usepackage{lmodern}
\renewcommand{\ttdefault}{pcr}
\usepackage{fancyvrb}

\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
          % Add ',fontsize=\small' for more characters per line
\newenvironment {Shaded}
        {\begin{mdframed}[style=code] }
         {\end{mdframed}}

\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.1,0.1,0.1}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.1,0.1,0.1}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.1,0.1,0.1}{\textbf{#1}}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.4,0.4,0.4}{{#1}}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.1,0.1,0.1}{{#1}}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.4,0.4,0.4}{{#1}}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.4,0.4,0.4}{{#1}}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.4,0.4,0.4}{{#1}}}
\newcommand{\CommentTok}[1]{\textcolor[RGB]{128,128,128}{\textit{#1}}}
\newcommand{\OtherTok}[1]{#1}
\newcommand{\AlertTok}[1]{\textbf{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.2,0.2,0.2}{#1}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\ErrorTok}[1]{\textbf{#1}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{{\textbf{#1}}}
\newcommand{\ControlFlowTok}[1]{{\textbf{#1}}}
\newcommand{\VariableTok}[1]{#1}




% ============ style inline code ===================
\BeforeBeginEnvironment{verbatim}{\begin{mdframed}[style=code]\shorthandoff{"}}
\AfterEndEnvironment{verbatim}{\shorthandon{"}\end{mdframed}\unskip}
\begingroup\lccode`~=`"
\lowercase{\endgroup
  \xapptocmd\ttfamily{\let~"}{}{}
}

% ============== E.Tutorial Setings ===============





% =========== books stuff ===================

\usepackage{scrlayer-scrpage}
\ohead{}
\cehead{}
\cohead{}

\newpairofpagestyles[scrheadings]{impressum}{\cfoot{\footnotesize  Version: $version.number$, Datum: $version.date$, Hash:  $version.hash$}}



%\renewcommand{\chaptermarkformat}{}
%\renewcommand{\sectionmarkformat}{}

% handle page in toc
\usepackage{tocstyle}
\usetocstyle{classic}

%\addto\captionsngerman{\renewcommand{\partname}{}} % remove part name

% add remove from reset to remove counter from beeing resetted
\def\@removefromreset#1#2{\let\@tempb\@elt
   \def\@tempa#1{@&#1}\expandafter\let\csname @*#1*\endcsname\@tempa
   \def\@elt##1{\expandafter\ifx\csname @*##1*\endcsname\@tempa\else
         \noexpand\@elt{##1}\fi}%
   \expandafter\edef\csname cl@#2\endcsname{\csname cl@#2\endcsname}%
   \let\@elt\@tempb
   \expandafter\let\csname @*#1*\endcsname\@undefined}

%reset counter after each part
\makeatletter
\@addtoreset{section}{part}
\@removefromreset{section}{chapter}
\makeatother
\renewcommand\thepart{\arabic{part}}
\setcounter{part}{$output.parts$}

%set chapter number
\renewcommand{\thechapter}{}
\renewcommand*\thesection{\thepart.\arabic{section}}
\renewcommand*\thetable{\thepart.\arabic{table}}
\renewcommand*\thefigure{\thepart.\arabic{figure}}
%center chapter
\addtokomafont{chapter}{\centering}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}


\usepackage{multicol}
\usepackage{enumitem}


\title{$title.main$}
\author{
$for(author)$$author.name$$sep$ \And $endfor$
}


$preamble$
% ============ Links ================
\usepackage{hyperref}
\hypersetup{%
  colorlinks,
  linkcolor=black,
  citecolor=infoColor,
  urlcolor=infoColor
}

\begin{document}
\frontmatter
\begin{titlepage}
\begin{center}

\vspace*{3 cm} {\large \textsf{$for(author)$$author.name$$sep$, $endfor$}}

$if(title.course)$
\vspace{1.5 cm} {\huge \textsf{$title.course$}}
$endif$

\vspace{0.5 cm} {\Huge \textbf{ \textsf{ $title.main$}}}\\
\vspace{0.5 cm} {\huge \textsf{$title.subtitle$}}


\end{center}
\cleardoublepage
\par
\raisebox{0pt}{\includegraphics[width=0.25\textwidth]{figures/Logo.png}}%
\hfill
\par

\begin{center}
\vspace{3 cm}
\noindent\rule{\textwidth}{0.4pt}


$if(title.course)$
\vspace{0.5 cm} {\huge \textsf{$title.course$}}\\
$endif$
\vspace{0.5 cm} {\Huge \textbf{ \textsf{ $title.main$}}}\\
\vspace{0.5 cm} {\huge \textsf{$title.subtitle$}}

\noindent\rule{\textwidth}{0.4pt}

\vspace*{1.5 cm} {\large \textsf{$for(author)$$author.name$$sep$, $endfor$}}

\clearpage


\thispagestyle{impressum}
\null
\vfill



\begin{center}
Trotz sorgfältiger Arbeit schleichen sich manchmal Fehler ein. Die Autoren sind Ihnen für Anregungen und Hinweise per Email an $contact.email$ dankbar!\\

\end{center}

\begin{center}
   Dieses Material steht unter der Creative-Commons-Lizenz\\
   \href{http://creativecommons.org/licenses/by-nc-nd/4.0/deed.de}{Namensnennung - Nicht kommerziell - Keine Bearbeitungen 4.0 International.} \\
    \end{center}
    \begin{center}
        \href{http://creativecommons.org/licenses/by-nc-nd/4.0/deed.de}{\includegraphics[scale=0.2]{figures/by-nc-nd_eu.png}}
    \end{center}
	\begin{center}
       Um eine Kopie dieser Lizenz zu sehen, besuchen Sie\\
       \href{http://creativecommons.org/licenses/by-nc-nd/4.0/deed.de}{http://creativecommons.org/licenses/by-nc-nd/4.0/deed.de}\\
	\end{center}
	Herstellung und Verlag: BoD – Books on Demand, Norderstedt\\
	$if(book.isbn)$
	  \vspace{0.3cm}
    {ISBN $book.isbn$}\\
	  \vspace{0.3cm}
\begin{minipage}{0.73\textwidth}
\begin{flushleft}
\begin{small}
  Bibliografische Information der Deutschen Nationalbibliothek\\
  Die Deutsche Nationalbibliothek verzeichnet diese Publikation in der Deutschen Nationalbibliografie; detaillierte bibliografische Daten sind im Internet über \href{http://dnb.dnb.de}{http://dnb.dnb.de} abrufbar.
\end{small}
\end{flushleft}
\end{minipage}
$endif$
\end{center}
\end{titlepage}
\cleardoublepage

\setcounter{tocdepth}{2}
\tableofcontents

\mainmatter

$body$


\end{document}

